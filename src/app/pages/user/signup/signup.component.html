<div class="signup-container">
  <!-- Company Logo -->
  <form [formGroup]="signupForm" (ngSubmit)="onSubmit()">
    <div class="logo" style="text-align: center;">
      <img src="assets/images/magh.png" alt="Company Logo">
    </div>

    <!-- Success and Error Alerts -->
    <div *ngIf="message" [ngClass]="{'success-message': messageType === 'success', 'error-message': messageType === 'error'}">
      <span *ngIf="messageType === 'success'">✅</span>
      <span *ngIf="messageType === 'error'">❌</span>
      {{ message }}
    </div>

    <!-- CIN Field -->
    <div class="form-group">
      <label for="cin" style="color:#004a8d;">CIN :</label>
      <input id="cin" type="text" formControlName="cin" 
             [ngClass]="{'is-invalid': signupForm.get('cin')?.touched && signupForm.get('cin')?.invalid}">
      <div *ngIf="signupForm.get('cin')?.touched && signupForm.get('cin')?.invalid">
        <small class="error-message" *ngIf="signupForm.get('cin')?.errors?.['required']">
          CIN is required.
        </small>
        <small class="error-message" *ngIf="signupForm.get('cin')?.errors?.['minlength'] || signupForm.get('cin')?.errors?.['maxlength']">
          CIN must be exactly 8 characters.
        </small>
      </div>
    </div>

    <!-- Name Field -->
    <div class="form-group">
      <label for="name" style="color:#004a8d;">Name :</label>
      <input id="name" type="text" formControlName="name" 
             [ngClass]="{'is-invalid': signupForm.get('name')?.touched && signupForm.get('name')?.invalid}">
      <div *ngIf="signupForm.get('name')?.touched && signupForm.get('name')?.invalid">
        <small class="error-message" *ngIf="signupForm.get('name')?.errors?.['required']">
          Name is required.
        </small>
        <small class="error-message" *ngIf="signupForm.get('name')?.errors?.['minlength']">
          Name must be at least 5 characters.
        </small>
      </div>
    </div>

    <!-- Email Field -->
    <div class="form-group">
      <label for="email" style="color:#004a8d;">Email :</label>
      <input id="email" type="email" formControlName="email" 
             [ngClass]="{'is-invalid': signupForm.get('email')?.touched && signupForm.get('email')?.invalid}">
      <div *ngIf="signupForm.get('email')?.touched && signupForm.get('email')?.invalid">
        <small class="error-message" *ngIf="signupForm.get('email')?.errors?.['required']">
          Email is required.
        </small>
        <small class="error-message" *ngIf="signupForm.get('email')?.errors?.['email']">
          Please enter a valid email.
        </small>
      </div>
    </div>

    <!-- Location Field -->
    <div class="form-group">
      <label for="location" style="color:#004a8d;">Location :</label>
      <select id="location" formControlName="location" 
              [ngClass]="{'is-invalid': signupForm.get('location')?.touched && signupForm.get('location')?.invalid}">
        <option value="">Select your location</option>
        <option value="Tunis">Tunis</option>
        <option value="Ariana">Ariana</option>
        <option value="Ben Arous">Ben Arous</option>
        <option value="Manouba">Manouba</option>
        <option value="Nabeul">Nabeul</option>
        <option value="Zaghouan">Zaghouan</option>
        <option value="Bizerte">Bizerte</option>
        <option value="Béja">Béja</option>
        <option value="Jendouba">Jendouba</option>
        <option value="Kef">Kef</option>
        <option value="Siliana">Siliana</option>
        <option value="Sousse">Sousse</option>
        <option value="Monastir">Monastir</option>
        <option value="Mahdia">Mahdia</option>
        <option value="Sfax">Sfax</option>
        <option value="Kairouan">Kairouan</option>
        <option value="Kasserine">Kasserine</option>
        <option value="Sidi Bouzid">Sidi Bouzid</option>
        <option value="Gabès">Gabès</option>
        <option value="Medenine">Medenine</option>
        <option value="Tataouine">Tataouine</option>
        <option value="Gafsa">Gafsa</option>
        <option value="Tozeur">Tozeur</option>
        <option value="Kebili">Kebili</option>
      </select>
      <div *ngIf="signupForm.get('location')?.touched && signupForm.get('location')?.invalid">
        <small class="error-message" *ngIf="signupForm.get('location')?.errors?.['required']">
          Location is required.
        </small>
      </div>
    </div>

    <!-- Age Field -->
    <div class="form-group">
      <label for="age" style="color:#004a8d;">Age :</label>
      <input id="age" type="number" formControlName="age" 
             [ngClass]="{'is-invalid': signupForm.get('age')?.touched && signupForm.get('age')?.invalid}">
      <div *ngIf="signupForm.get('age')?.touched && signupForm.get('age')?.invalid">
        <small class="error-message" *ngIf="signupForm.get('age')?.errors?.['required']">
          Age is required.
        </small>
        <small class="error-message" *ngIf="signupForm.get('age')?.errors?.['min']">
          You must be at least 18 years old.
        </small>
      </div>
    </div>

    <!-- Gender Field -->
    <div class="form-group">
      <label for="gender" style="color:#004a8d;">Gender :</label>
      <select id="gender" formControlName="gender" 
              [ngClass]="{'is-invalid': signupForm.get('gender')?.touched && signupForm.get('gender')?.invalid}">
        <option value="">Select your gender</option>
        <option value="Male">Male</option>
        <option value="Female">Female</option>
      </select>
      <div *ngIf="signupForm.get('gender')?.touched && signupForm.get('gender')?.invalid">
        <small class="error-message" *ngIf="signupForm.get('gender')?.errors?.['required']">
          Gender is required.
        </small>
      </div>
    </div>

    <!-- Password Field -->
    <div class="form-group">
      <label for="password" style="color:#004a8d;">Password :</label>
      <input id="password" type="password" formControlName="password" 
             [ngClass]="{'is-invalid': signupForm.get('password')?.touched && signupForm.get('password')?.invalid}">
      <div *ngIf="signupForm.get('password')?.touched && signupForm.get('password')?.invalid">
        <small class="error-message" *ngIf="signupForm.get('password')?.errors?.['required']">
          Password is required.
        </small>
        <small class="error-message" *ngIf="signupForm.get('password')?.errors?.['pattern']">
          Password must be at least 6 characters long, contain at least one uppercase letter and one symbol.
        </small>
      </div>
    </div>

    <!-- Profile Image Field -->
    <div class="form-group">
      <label style="color:#004a8d;">Upload Image :</label>
      <div class="image-upload-container">
        <!-- Hidden file input -->
        <input type="file" #fileInput (change)="onFileSelected($event)" accept="image/*" style="display: none;">
        
        <!-- Clickable upload logo -->
        <div class="upload-logo" (click)="fileInput.click()">
          <img src="/assets/images/image-upload.png" alt="Upload Logo" class="upload-icon">
        </div>
        
        <!-- Image preview -->
        <div class="image-preview" *ngIf="imagePreview">
          <img [src]="imagePreview" alt="Preview">
          <button type="button" class="btn btn-sm btn-danger" (click)="removeImage(fileInput)">×</button>
        </div>
      </div>
      <small>If no image is selected, a default profile image will be used.</small>
    </div>
    
    <button type="submit" [disabled]="loading" class="submit-btn">
      {{ loading ? 'Signing Up...' : 'Sign Up' }}
    </button>
  </form>
  <p class="signup-link">
    Already have an account? <a routerLink="/login">Login</a>
  </p>
</div>
