<h3>Liste des Sinistres (Admin)</h3>

<!-- Graphique des sinistres par statut -->
<div class="mb-4">
  <canvas id="sinistreChart"></canvas>
</div>

<!-- Rechercher et filtrer -->
<div class="row mb-3">
  <div class="col-md-6">
    <input type="text" [(ngModel)]="searchText" (ngModelChange)="filterSinistres()" placeholder="Rechercher par description ou lieu..." class="form-control form-control-lg" />
  </div>
  <div class="col-md-6">
    <select [(ngModel)]="selectedStatut" (change)="filterSinistres()" class="form-control form-control-lg">
      <option value="">Tous les statuts</option>
      <option *ngFor="let statut of statutsDisponibles" [value]="statut">{{ statut }}</option>
    </select>
  </div>
</div>

<!-- Chargement en cours -->
<div *ngIf="isLoading">
  <p>Chargement en cours...</p>
</div>

<!-- Message d'erreur -->
<div *ngIf="errorMessage" class="alert alert-danger">
  {{ errorMessage }}
  <button (click)="loadSinistres()" class="btn btn-secondary btn-lg">Réessayer</button>
</div>

<!-- Liste des sinistres -->
<table class="table table-hover mt-3" *ngIf="!isLoading && !errorMessage && filteredSinistres.length > 0">
  <thead>
    <tr>
      <th (click)="sortData('id')">ID</th>
      <th (click)="sortData('dateDeclaration')">Date Déclaration</th>
      <th (click)="sortData('description')">Description</th>
      <th (click)="sortData('statut')">Statut</th>
      <th (click)="sortData('montantEstime')">Montant Estimé</th>
      <th (click)="sortData('lieu')">Lieu</th>
      <th (click)="sortData('typeSinistre')">Type Sinistre</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let sinistre of filteredSinistres">
      <td>{{ sinistre.id }}</td>
      <td>{{ sinistre.dateDeclaration | date }}</td>
      <td>{{ sinistre.description }}</td>
      <td>{{ sinistre.statut }}</td>
      <td>{{ sinistre.montantEstime }}</td>
      <td>{{ sinistre.lieu }}</td>
      <td>{{ sinistre.typeSinistre }}</td>
      <td>
       <button (click)="deleteSinistre(sinistre.id)" class="btn btn-danger btn-sm">Supprimer</button>



      </td>
    </tr>
  </tbody>
</table>
